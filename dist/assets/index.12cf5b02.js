var $=Object.defineProperty;var x=(s,e,t)=>e in s?$(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var a=(s,e,t)=>(x(s,typeof e!="symbol"?e+"":e,t),t);import{v as M,d as g,c as p,a as m,b as h,w as v,Q as _,o as l,e as S,f as b,r as I,g as A,h as P,i as T,j as N,q as C}from"./vendor.aae08389.js";const L=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}};L();class u{constructor(e="scene-object",t){a(this,"type");a(this,"image",{});this.type=e,this.image=t}operation(e){const t=JSON.stringify(this.image),i=JSON.stringify(e);console.log(`Flyweight: Displaying shared (${t}) and unique (${i}) state.`)}getType(){return this.type}}const w=class extends u{constructor(e,t){super(`${w.type}-${t}`,e)}};let f=w;a(f,"type","Missile");class E{constructor(e,t,i,n=[]){a(this,"objects",[]);a(this,"movingObjects",[]);a(this,"currentAnimation",0);a(this,"images",{});a(this,"canvas",{});a(this,"ctx",{});a(this,"fps",30);a(this,"animationId");this.canvas=e,this.ctx=t,this.images=i;for(const r of n)this.addObjectToScene(r)}addObjectToScene(e){const t=e.getType();if(this.isObjectCached(t)){this.movingObjects.push(e);return}const i=this.getImageByType(t);!i||(this.objects.push(new u(t,i)),this.movingObjects.push(e))}isObjectCached(e){return!!this.getSceneObjectByType(e)}getSceneObjectByType(e){for(const t of this.objects)if(e===t.getType())return t;return!1}doForAllMovingObjects(e,...t){let i=[];for(const n of this.movingObjects)i.push(e(n,...t));return i}getImageByType(e){return this.images[e]}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(const e of this.movingObjects)e.draw(this.ctx,this.canvas.width,this.canvas.height,this.getSceneObjectByType(e.getType()))}animation(){this.animationId||(this.animationId=setInterval(()=>{this.doForAllMovingObjects(e=>{e.getType().startsWith(f.type)&&e.calculateNewPosition()})},4))}start(){const e=t=>{setTimeout(()=>{this.currentAnimation&&(this.draw(),this.currentAnimation=window.requestAnimationFrame(e))},1e3/this.fps),this.animation()};this.currentAnimation||(this.currentAnimation=window.requestAnimationFrame(e))}stop(){typeof this.currentAnimation=="number"&&(this.currentAnimation=void 0),this.animationId&&(clearInterval(this.animationId),this.animationId=void 0)}changeGameSettings(e,t){this[`${e}`]=t}changeObjectsProperty(e,t){this.doForAllMovingObjects((i,n,r)=>{i.hasOwnProperty(n)?i[`${n}`]=r:console.error(`MovingSceneObject-ID: ${i.objId} 
 MovingSceneObject-Type: ${i.getType()} 
 Key: ${n} 
 Value: ${r} `)},e,t)}changeMovingObjectPropertyById(e,t,i){this.doForAllMovingObjects((n,r,o)=>{n.objId===e&&n.hasOwnProperty(r)&&(n[`${r}`]=o)},e,t,i)}}const j=.2;class B{constructor(e,t,i,n=1){a(this,"position");a(this,"direction");a(this,"speed");a(this,"objType");a(this,"objId");a(this,"target");a(this,"steeringForce",1);this.position=e,this.direction=t.normalize(),this.objType=i,this.speed=n,this.objId=M()}draw(e,t,i,n){if(n instanceof u){const{width:r,height:o}=n.image;this.direction=this.direction.normalize(),e.save();let d=Math.atan(this.direction.y/this.direction.x);this.direction.x<0&&(d+=Math.PI),e.translate(this.position.x,this.position.y),e.rotate(d+Math.PI*.5),e.scale(j,j),e.fillStyle="red",e.strokeStyle="red",e.drawImage(n.image,-r*.5,-o*.5),e.restore()}}calculateNewPosition(){this.position=this.position.add(this.direction.mul(this.speed)),this.target===this.position&&(this.target=void 0),this.direction=this.steerWithForce(this.position,this.direction,this.target,this.steeringForce)}steerWithForce(e=this.position,t=this.direction,i=this.target,n=this.steeringForce){if(!i)return t;const o=i.sub(e).sub(t);return t.add(o.normalize().mul(n/1e3)).normalize()}getType(){return this.objType}}class c{constructor(e=0,t=0){a(this,"x");a(this,"y");this.x=e,this.y=t}static fromDegree(e){return new c(Math.cos(e*Math.PI/180),Math.sin(e*Math.PI/180))}static random(e=1){let t=1;Math.random()<=.5&&(t=-1);let i=1;return Math.random()<=.5&&(i=-1),new c(t*Math.random()*e,i*Math.random()*e)}normalize(){return this.mul(1/this.length())}length(){return Math.abs(Math.sqrt(this.x*this.x+this.y*this.y))}add(e){return new c(this.x+e.x,this.y+e.y)}sub(e){return new c(this.x-e.x,this.y-e.y)}mul(e){return new c(this.x*e,this.y*e)}}var y=(s,e)=>{const t=s.__vccOpts||s;for(const[i,n]of e)t[i]=n;return t};const z=g({name:"GameControls",props:{canvasId:{required:!0,type:String},presentation:{required:!0,type:Object}},mounted(){this.presentation.draw()},destroyed(){}}),q={class:"game-controls"},k={id:"slide-controls",class:"q-pa-md q-gutter-sm"},G=b(" Previous Slide "),R=b(" Next Slide ");function D(s,e,t,i,n,r){return l(),p("div",q,[m("div",k,[h(_,{class:"prev-slide",push:"",color:"primary",onClick:e[0]||(e[0]=o=>{s.presentation.prevSlide(),s.presentation.draw()})},{default:v(()=>[h(S,{left:"",size:"1em",name:"fas fa-solid fa-arrow-left"}),G]),_:1}),h(_,{class:"next-slide",push:"",color:"secondary",onClick:e[1]||(e[1]=o=>{s.presentation.nextSlide(),s.presentation.draw()})},{default:v(()=>[R,h(S,{size:"1em",right:"",name:"fas fa-solid fa-arrow-right"})]),_:1})])])}var V=y(z,[["render",D],["__scopeId","data-v-78828068"]]),U="/aswe-flyweight/assets/Missile_1_Flying_000.1296be13.png",W="/aswe-flyweight/assets/Missile_2_Flying_000.b1f02716.png",K="/aswe-flyweight/assets/Missile_3_Flying_000.c9c39387.png",Q="/aswe-flyweight/assets/Flyweight_1.9f15955a.png",H="/aswe-flyweight/assets/Flyweight_2.96a81aa2.png",J="/aswe-flyweight/assets/Flyweight_3.34d1c80f.png",X="/aswe-flyweight/assets/Flyweight_4.43a5c7cd.png",Y="/aswe-flyweight/assets/Flyweight_5.a3a85bc4.png",Z="/aswe-flyweight/assets/Flyweight_6.89b64d39.png",ee="/aswe-flyweight/assets/Flyweight_7.05e88ae3.png",te="/aswe-flyweight/assets/Flyweight_8.5ac323db.png",se="/aswe-flyweight/assets/Flyweight_9.af4f4f1f.png",ie="/aswe-flyweight/assets/Flyweight_10.54ba43ea.png",ne="/aswe-flyweight/assets/Flyweight_11.674c525d.png",re="/aswe-flyweight/assets/Flyweight_12.785e40f1.png";class F{constructor(e,t,i){a(this,"slides");a(this,"currentSlideIndex",0);a(this,"lastSlideIndex",0);a(this,"canvas");a(this,"ctx");this.canvas=e,this.ctx=t,this.slides=i}prevSlide(){if(this.currentSlideIndex===0){this.currentSlideIndex=0;return}this.currentSlideIndex--}nextSlide(){if(this.lastSlideIndex=this.currentSlideIndex,this.currentSlideIndex===this.slides.length-1){this.currentSlideIndex=this.slides.length-1;return}this.currentSlideIndex++}draw(){this.slides[this.currentSlideIndex].draw(this.canvas,this.slides[this.lastSlideIndex])}addSlides(e,t){if(t){((n,r,o)=>[...n.slice(0,r),...o,...n.slice(r)])(this.slides,t,e);return}this.slides.push(e)}sortSlides(){this.slides.sort((e,t)=>e.slideNumber===t.slideNumber?0:e.slideNumber<t.slideNumber?-1:1)}}class O{constructor(e,t,i=0){a(this,"content");a(this,"type");a(this,"slideNumber");this.content=e,this.type=t,this.slideNumber=i}draw(e,t,i=!1){if(console.log(t),t.getType()==="2d"){const r=t.getContentByKey("gameState");console.log("gameState: ",r),r==null||r.stop()}const n=e.getContext("2d");switch(i||n==null||n.clearRect(0,0,e.width,e.height),this.type){case"image":{const r=this.content;n.drawImage(r,0,0,r.width,r.height,0,0,e.width,e.height);break}case"2d":{const{gameState:r}=this.content;r.start()}}}getContentByKey(e){if(this.content.hasOwnProperty(e))return this.content[`${e}`]}getType(){return this.type}}const ae=g({name:"GameActions",props:{canvasId:{required:!0,type:String},gameState:{required:!0,type:Object}},data(){return{force:10}},methods:{clickAction(s){s.preventDefault(),s.stopPropagation();const{offsetX:e,offsetY:t}=s;this.gameState.changeObjectsProperty("target",new c(e,t)),this.gameState.changeObjectsProperty("steeringForce",this.force)},addEventListeners(){var s;(s=document.getElementById(this.canvasId))==null||s.addEventListener("mousedown",this.clickAction)},removeEventListeners(){var s;(s=document.getElementById(this.canvasId))==null||s.removeEventListener("mousedown",this.clickAction)}},mounted(){this.addEventListeners()},destroyed(){this.removeEventListeners()}});function oe(s,e,t,i,n,r){return l(),p("div")}var ce=y(ae,[["render",oe]]);const he=g({components:{GameActions:ce,GameControls:V},data(){return{canvas:{},ctx:{},gameSprites:{},slideImages:{},gameState:{},presentation:{},speed:1e-5,fps:30,testMissile:{}}},watch:{speed(s,e){s!==e&&s!==""&&this.gameState.changeObjectsProperty("speed",s)},fps(s,e){s!==e&&this.gameState.changeGameSettings("fps",s)}},methods:{async loadImages(s){const e={};for(const t of s)e[`${this.getFileName(t)}`]=await this.loadImage(t);return e},loadImage(s){return new Promise((e,t)=>{let i=new Image;i.crossOrigin="Anonymous",i.src=s,i.onload=()=>{e(i)},i.onerror=()=>t(i)})},getFileName(s){const e=s.match("([a-zA-Z0-9\\s_\\\\.\\-\\(\\):])+(.png|.jpeg|.pdf)$"),t=e==null?void 0:e[e.length-1].toString();if(t)return e==null?void 0:e[0].replace(t,"")},onResize(s){s==null||s.preventDefault(),s==null||s.stopPropagation(),this.canvas.width=window.outerWidth,this.canvas.height=window.innerHeight},addEventListeners(){window.addEventListener("resize",this.onResize)},removeEventListeners(){window.removeEventListener("resize",this.onResize)}},computed:{testFn(){if(!!this.gameState.changeObjectsProperty)return this.degrees},presentationAvailable(){return this.presentation instanceof F}},async mounted(){this.canvas=this.$refs.gameScene,this.ctx=this.canvas.getContext("2d"),this.onResize(),this.addEventListeners();try{const t=[Q,H,J,X,Y,Z,ee,te,se,ie,ne,re],i=[U,W,K];this.slideImages=await this.loadImages(t),this.gameSprites=await this.loadImages(i)}catch(t){console.error(`Not loading assets!
 ${t.src}`)}let s=[];this.gameState=new E(this.canvas,this.ctx,this.gameSprites);for(const t in this.gameSprites){const i=new B(c.random(this.canvas.width),c.random(),t,1);this.gameState.addObjectToScene(i)}const e=new O({gameState:this.gameState},"2d",4);s.push(e);for(const t of Object.keys(this.slideImages)){const i=parseInt(t.slice(t.indexOf("_")+1));let n=i;i>3&&(n+=1),s.push(new O(this.slideImages[t],"image",n))}this.presentation=new F(this.canvas,this.ctx,s),this.presentation.sortSlides(),this.presentation.draw()},destroyed(){this.removeEventListeners()}}),de={id:"app"},le={id:"game-scene",ref:"gameScene",width:1024,height:600},ge={class:"hide-wrapper"};function pe(s,e,t,i,n,r){const o=I("game-controls"),d=I("game-actions");return l(),p("div",de,[m("canvas",le,null,512),m("div",ge,[s.presentationAvailable?(l(),A(o,{key:0,id:"controls","canvas-id":"game-scene",presentation:s.presentation},null,8,["presentation"])):P("",!0)]),h(d,{"canvas-id":"game-scene","game-state":s.gameState},null,8,["game-state"])])}var me=y(he,[["render",pe]]);T(me).use(N,{plugins:{},iconSet:C}).mount("#app");
